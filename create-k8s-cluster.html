
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Creating a Kubernetes Cluster &#8212; Zero to JupyterHub with Kubernetes 0.4 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Setting up Helm" href="setup-helm.html" />
    <link rel="prev" title="Getting started with JupyterHub" href="getting-started.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class='prev-next-top'>
    
     <a class='left-prev' href="getting-started.html" title="previous chapter">Previous</a>
     <a class='right-next' href="setup-helm.html" title="next chapter">Next</a>
  <div style='clear:both;'></div>

  </div>

  
  <div class="section" id="creating-a-kubernetes-cluster">
<span id="create-k8s-cluster"></span><h1>Creating a Kubernetes Cluster<a class="headerlink" href="#creating-a-kubernetes-cluster" title="Permalink to this headline">¶</a></h1>
<p>Kubernetes’ documentation describes the many <a class="reference external" href="https://kubernetes.io/docs/setup/pick-right-solution/">ways to set up a cluster</a>.
Here, we shall provide quick instructions for the most painless and
popular ways of getting setup in various cloud providers:</p>
<ul class="simple">
<li><a class="reference internal" href="#google-cloud"><span class="std std-ref">Google Cloud</span></a></li>
<li><a class="reference internal" href="#microsoft-azure"><span class="std std-ref">Microsoft Azure</span></a></li>
<li><a class="reference internal" href="#amazon-aws"><span class="std std-ref">Amazon AWS</span></a></li>
<li>Red Hat OpenShift</li>
<li>Others</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">During the process of setting up JupyterHub, you’ll be creating some
files for configuration purposes. It may be helpful to create a folder
for your JuypterHub deployment to keep track of these files.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are concerned at all about security (you probably should be), see
the <a class="reference external" href="http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes-deployment.html">Kubernetes best-practices guide</a>
for information about keeping your Kubernetes infrastruture secure.</p>
</div>
<div class="section" id="setting-up-kubernetes-on-google-cloud">
<span id="google-cloud"></span><h2>Setting up Kubernetes on <a class="reference external" href="https://cloud.google.com/">Google Cloud</a><a class="headerlink" href="#setting-up-kubernetes-on-google-cloud" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://cloud.google.com/container-engine/">Google Container Engine</a>
(confusingly abbreviated to GKE) is the simplest and most common way of setting
up a Kubernetes Cluster. You may be able to receive <a class="reference external" href="https://cloud.google.com/free/">free credits</a> for trying it out. You will need to
connect your credit card or other payment method to your google cloud account.</p>
<ol class="arabic">
<li><p class="first">Go to <code class="docutils literal"><span class="pre">https://console.cloud.google.com</span></code> and log in.</p>
</li>
<li><p class="first">Enable the <a class="reference external" href="https://console.cloud.google.com/apis/api/container.googleapis.com/overview">Container Engine API</a>.</p>
</li>
<li><p class="first">Install and initialize the <strong>gcloud command-line tools</strong>. These tools send
commands to Google Cloud and lets you do things like create and delete
clusters.</p>
<ul>
<li><p class="first">Go to the <a class="reference external" href="https://cloud.google.com/sdk/downloads">gcloud downloads page</a>
to <strong>download and install the gcloud SDK</strong>.</p>
</li>
<li><p class="first">See the <a class="reference external" href="https://cloud.google.com/sdk/">gcloud documentation</a> for
more information on the gcloud SDK.</p>
</li>
<li><p class="first">Install <code class="docutils literal"><span class="pre">kubectl</span></code>, which is a tool for controlling kubernetes. From
the terminal, enter:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>gcloud components install kubectl
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Create a Kubernetes cluster on Google Cloud, by typing in the following
command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>gcloud container clusters create &lt;YOUR_CLUSTER&gt; <span class="se">\</span>
    --num-nodes<span class="o">=</span><span class="m">3</span> <span class="se">\</span>
    --machine-type<span class="o">=</span>n1-standard-2 <span class="se">\</span>
    --zone<span class="o">=</span>us-central1-b <span class="se">\</span>
    --cluster-version<span class="o">=</span><span class="m">1</span>.8.4-gke.0
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--num-nodes</span></code> specifies how many computers to spin up. The higher the
number, the greater the cost.</li>
<li><code class="docutils literal"><span class="pre">--machine-type</span></code> specifies the amount of CPU and RAM in each node. There
is a <a class="reference external" href="https://cloud.google.com/compute/docs/machine-types">variety of types</a>
to choose from. Picking something appropriate here will have a large effect
on how much you pay - smaller machines restrict the max amount of RAM each
user can have access to but allow more fine-grained scaling, reducing cost.
The default (<code class="docutils literal"><span class="pre">n1-standard-2</span></code>) has 2CPUs and 7.5G of RAM each, and might not
be a good fit for all use cases!</li>
<li><code class="docutils literal"><span class="pre">--zone</span></code> specifies which data center to use. Pick something that is not
too far away from your users. You can find a list of them <a class="reference external" href="https://cloud.google.com/compute/docs/regions-zones/regions-zones#available">here</a>.</li>
<li><code class="docutils literal"><span class="pre">--cluster-version</span></code> specifies the version of kubernetes we want. Here,
we specify the minimum that the default configuration will support.</li>
</ul>
</li>
<li><p class="first">To test if your cluster is initialized, run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>kubectl get node
</pre></div>
</div>
<p>The response should list three running nodes.</p>
</li>
<li><p class="first">Give your account super-user permissions, allowing you to perform all
the actions needed to set up JupyterHub.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>kubectl create clusterrolebinding cluster-admin-binding --clusterrole<span class="o">=</span>cluster-admin --user<span class="o">=</span>&lt;your-email-address&gt;
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="setting-up-kubernetes-on-microsoft-azure-container-service-acs">
<span id="microsoft-azure"></span><h2>Setting up Kubernetes on Microsoft Azure Container Service (ACS)<a class="headerlink" href="#setting-up-kubernetes-on-microsoft-azure-container-service-acs" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is an alpha work-in-progress - please do not use in production! Help from
people with more Azure experience would be highly welcome :)</p>
</div>
<ol class="arabic">
<li><p class="first">Install and initialize the <strong>Azure command-line tools</strong>, which send commands
to Azure and let you do things like create and delete clusters.</p>
<ul class="simple">
<li>Go to the <a class="reference external" href="https://github.com/Azure/azure-cli">azure-cli github repo</a>
to download and install the <strong>azure-cli</strong> tools.</li>
<li>See the <a class="reference external" href="https://docs.microsoft.com/en-us/cli/azure/acs">az documentation</a>
for more information on using the <code class="docutils literal"><span class="pre">az</span></code> tool with the Azure Container
Service.</li>
</ul>
</li>
<li><p class="first">Authenticate the <code class="docutils literal"><span class="pre">az</span></code> tool so it may access your Azure account:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>az login
</pre></div>
</div>
</li>
<li><p class="first">Specify a <a class="reference external" href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-overview#resource-groups">Azure resource group</a>, and create one if it doesn’t already
exist:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">RESOURCE_GROUP</span><span class="o">=</span>&lt;YOUR_RESOURCE_GROUP&gt;
<span class="nb">export</span> <span class="nv">LOCATION</span><span class="o">=</span>&lt;YOUR_LOCATION&gt;
az group create --name<span class="o">=</span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span> --location<span class="o">=</span><span class="si">${</span><span class="nv">LOCATION</span><span class="si">}</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--name</span></code> specifies your Azure resource group. If a group doesn’t exist,
az will create it for you.</li>
<li><code class="docutils literal"><span class="pre">--location</span></code> specifies which computer center to use.  To reduce latency,
choose a zone closest to whoever is sending the commands. View available
zones via <code class="docutils literal"><span class="pre">az</span> <span class="pre">account</span> <span class="pre">list-locations</span></code>.</li>
</ul>
</div></blockquote>
<ol class="arabic" start="5">
<li><p class="first">Install <code class="docutils literal"><span class="pre">kubectl</span></code>, a tool for controlling Kubernetes:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>az acs kubernetes install-cli
</pre></div>
</div>
</li>
<li><p class="first">Create a Kubernetes cluster on Azure, by typing in the following commands:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CLUSTER_NAME</span><span class="o">=</span>&lt;YOUR_CLUSTER_NAME&gt;
<span class="nb">export</span> <span class="nv">DNS_PREFIX</span><span class="o">=</span>&lt;YOUR_PREFIX&gt;
az acs create --orchestrator-type<span class="o">=</span>kubernetes <span class="se">\</span>
    --resource-group<span class="o">=</span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span> <span class="se">\</span>
    --name<span class="o">=</span><span class="si">${</span><span class="nv">CLUSTER_NAME</span><span class="si">}</span> <span class="se">\</span>
    --dns-prefix<span class="o">=</span><span class="si">${</span><span class="nv">DNS_PREFIX</span><span class="si">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Authenticate kubectl:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>az acs kubernetes get-credentials <span class="se">\</span>
    --resource-group<span class="o">=</span><span class="si">${</span><span class="nv">RESOURCE_GROUP</span><span class="si">}</span> <span class="se">\</span>
    --name<span class="o">=</span><span class="si">${</span><span class="nv">CLUSTER_NAME</span><span class="si">}</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--resource-group</span></code> specifies your Azure resource group.</li>
<li><code class="docutils literal"><span class="pre">--name</span></code> is your ACS cluster name.</li>
<li><code class="docutils literal"><span class="pre">--dns-prefix</span></code> is the domain name prefix for the cluster.</li>
</ul>
</div></blockquote>
<ol class="arabic" start="8">
<li><p class="first">To test if your cluster is initialized, run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>kubectl get node
</pre></div>
</div>
<p>The response should list three running nodes.</p>
</li>
</ol>
</div>
<div class="section" id="setting-up-kubernetes-on-amazon-web-services-aws">
<span id="amazon-aws"></span><h2>Setting up Kubernetes on Amazon Web Services (AWS)<a class="headerlink" href="#setting-up-kubernetes-on-amazon-web-services-aws" title="Permalink to this headline">¶</a></h2>
<p>AWS does not have native support for Kubernetes, however there are
many organizations that have put together their own solutions and
guides for setting up Kubernetes on AWS.</p>
<p>We like the <a class="reference external" href="https://s3.amazonaws.com/quickstart-reference/heptio/latest/doc/heptio-kubernetes-on-the-aws-cloud.pdf">Heptio guide</a>, and recommend using this for setting up your cluster for clusters
that span short periods of time (a week long workshop, for example). However, if
you are setting up a cluster that would need to run for much longer, we recommend you use
[kops](<a class="reference external" href="https://kubernetes.io/docs/getting-started-guides/kops/">https://kubernetes.io/docs/getting-started-guides/kops/</a>). It is a bit more complex,
but provides features (such as log collection &amp; cluster upgrades) that are necessary to
run a longer term cluster.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Heptio deployment of Kubernetes on AWS should not be considered
production-ready. See <a class="reference external" href="http://docs.heptio.com/content/tutorials/aws-cloudformation-k8s.html">the introduction in the Heptio Kubernetes tutorial</a>
for information about what to expect.</p>
</div>
<ol class="arabic">
<li><p class="first">Follow Step 1 of the <a class="reference external" href="https://s3.amazonaws.com/quickstart-reference/heptio/latest/doc/heptio-kubernetes-on-the-aws-cloud.pdf">Heptio guide</a>, called <strong>Prepare your AWS Account</strong>.</p>
<p>This sets up your Amazon account with the credentials needed to run Kubernetes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure that you keep the file downloaded when you create the SSH
key. This will be needed later to allow <code class="docutils literal"><span class="pre">kubectl</span></code> to interact with
your Kubernetes cluster.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may find it helpful to “pin” the services we’ll be using to your AWS
navbar. This makes it easier to navigate in subsequent sessions.
Click the “pin” icon at the top, then drag <code class="docutils literal"><span class="pre">CloudFormation</span></code> and
<code class="docutils literal"><span class="pre">EC2</span></code> into your navbar.</p>
</div>
</li>
<li><p class="first">Deploy a Kubernetes template from Heptio.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section largely follows Step 2 of the <a class="reference external" href="https://s3.amazonaws.com/quickstart-reference/heptio/latest/doc/heptio-kubernetes-on-the-aws-cloud.pdf">Heptio guide</a>.</p>
</div>
<p>AWS makes it possible to deploy computational resources in a “stack” using
templates. Heptio has put together a template for running Kubernetes on AWS.
Click the button below to select the Heptio template, then follow the
instructions below.</p>
<a target="_blank" href="https://console.aws.amazon.com/cloudformation/home?region=us-west-2#/stacks/new?stackName=Heptio-Kubernetes&templateURL=https://s3.amazonaws.com/quickstart-reference/heptio/latest/templates/kubernetes-cluster-with-new-vpc.template">
<button style="background-color: rgb(235, 119, 55); border: 1px solid; border-color: black; color: white; padding: 15px 32px; text-align: center; text-decoration: none; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 8px;">Deploy the Heptio Template</button></a><p>You’ll be taken to an AWS page with a field already
chosen under “Choose a template”. Simply hit “Next”.</p>
<p><strong>Enter AWS instance information (page 1)</strong>: On this page you’ll tell AWS
what kind of hardware you need. Fill in the following required fields:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Stack</span> <span class="pre">Name</span></code> can be anything you like.</li>
<li><code class="docutils literal"><span class="pre">Availability</span> <span class="pre">Zone</span></code> is related to the location of the AWS
resources. Choose an AWS location close to your physical location or
any other desired AWS location.</li>
<li><code class="docutils literal"><span class="pre">Admin</span> <span class="pre">Ingress</span> <span class="pre">Location</span></code> defines the locations from which you
can access this cluster as an administrator. Enter <code class="docutils literal"><span class="pre">0.0.0.0/0</span></code>
for the most permissive approach.</li>
<li><code class="docutils literal"><span class="pre">SSH</span> <span class="pre">Key</span></code> is a dropdown list of keys attached to your account.
The one you created in Step 1 should be listed here. This will allow
you to SSH into the machines if you desire.</li>
<li><code class="docutils literal"><span class="pre">Node</span> <span class="pre">Capacity</span></code> defines the number of machines you’ve got available.
This will depend on the <code class="docutils literal"><span class="pre">Instance</span> <span class="pre">Type</span></code> that you choose. E.g., if you
want each user to have 2GB and you expect 10 users, choose a combination
of <code class="docutils literal"><span class="pre">Instance</span> <span class="pre">Type</span></code> and <code class="docutils literal"><span class="pre">Node</span> <span class="pre">Capacity</span></code> that meets this requirement.</li>
<li><code class="docutils literal"><span class="pre">Instance</span> <span class="pre">Type</span></code> defines what kind of machine you’re requesting. See
this <a class="reference external" href="https://aws.amazon.com/ec2/instance-types/">list of instance types with Amazon</a>
as well as this list of <a class="reference external" href="https://aws.amazon.com/ec2/pricing/on-demand/">pricing for each instance type</a>.</li>
<li><code class="docutils literal"><span class="pre">Disk</span> <span class="pre">Size</span></code> corresponds to the hard disk for each node. Note that this is
different from the disks that users will use for their own notebooks/data.
This disk should be large enough to contain the size of any Docker
images you’re serving with the JupyterHub.</li>
<li><code class="docutils literal"><span class="pre">Instance</span> <span class="pre">Type</span> <span class="pre">(Bastion</span> <span class="pre">Host)</span></code> corresponds to a computer that allows
for easy SSH access to your Kubernetes cluster. This does not need to
be a fancy computer. You may leave these as defaults. For more information
on the Bastion Host, <a class="reference external" href="http://docs.aws.amazon.com/quickstart/latest/linux-bastion/architecture.html">see here</a>.</li>
</ul>
<p><strong>Enter AWS instance information (page 2)</strong>: On the second page you may leave
all of these fields as is or customize as you wish. When done, hit <code class="docutils literal"><span class="pre">Next</span></code>. Then
confirm and hit <code class="docutils literal"><span class="pre">Next</span></code> once more.</p>
<p>AWS will now create the computational resources defined in the Heptio
template (and according to the options that you chose).</p>
<p>To see the status of the resources you’ve requested,
see the <code class="docutils literal"><span class="pre">CloudFormation</span></code> page. You should see two stacks being created,
each will have the name you’ve requested. When they’re done creating,
continue with the guide.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This often takes 15-20 minutes to finish. You’ll know it’s done when
both stacks show the status <code class="docutils literal"><span class="pre">CREATE_COMPLETE</span></code>.</p>
</div>
</li>
<li><p class="first">Ensure that the <em>latest</em> version of <a class="reference external" href="https://kubernetes.io/docs/user-guide/prereqs/">kubectl</a> is
installed on your machine be following the <a class="reference external" href="https://kubernetes.io/docs/user-guide/prereqs">install instructions</a>.</p>
</li>
<li><p class="first">Configure your <code class="docutils literal"><span class="pre">kubectl</span></code> to send instructions to the newly-created
Kubernetes cluster. To do this, you’ll need to copy a security file
onto your computer. Heptio has pre-configured the command needed to do this.
To access it, from the <code class="docutils literal"><span class="pre">CloudFormation</span></code> page click on the stack you just
created (the one without “k8s-stack” in it). Below, there is an “Outputs”
tab. Click on this, and look for a field called <code class="docutils literal"><span class="pre">GetKubeConfigCommand</span></code>.
Copy / paste that text into your terminal, replacing the <code class="docutils literal"><span class="pre">path/to/myKey.pem</span></code>
with the path to the key you downloaded in Step 1. It looks something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>SSH_KEY=&quot;&lt;path/to/varMyKey.pem&gt;&quot;; scp -i $SSH_KEY -o
ProxyCommand=&quot;ssh -i \&quot;${SSH_KEY}\&quot; ubuntu@&lt;BastionHostPublicIP&gt; nc
%h %p&quot; ubuntu@&lt;MasterPrivateIP&gt;:~/kubeconfig ./kubeconfig
</pre></div>
</div>
</li>
<li><p class="first">Tell Kubernetes to use this configuration file. Run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>export KUBECONFIG=$(pwd)/kubeconfig
</pre></div>
</div>
</li>
<li><p class="first">Confirm that <code class="docutils literal"><span class="pre">kubectl</span></code> is connected to your Kubernetes cluster.
Run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">kubectl</span> <span class="n">get</span> <span class="n">nodes</span>
</pre></div>
</div>
<p>you should see a list of three nodes, each beginning with <code class="docutils literal"><span class="pre">ip</span></code>.</p>
</li>
<li><p class="first">Enable dynamic storage on your Kubernetes cluster.
Create a file, <code class="docutils literal"><span class="pre">storageclass.yml</span></code> on your local computer, and enter
this text:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">kind</span><span class="p">:</span> <span class="n">StorageClass</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">k8s</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">annotations</span><span class="p">:</span>
     <span class="n">storageclass</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="ow">is</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="n">class</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">gp2</span>
<span class="n">provisioner</span><span class="p">:</span> <span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">aws</span><span class="o">-</span><span class="n">ebs</span>
<span class="n">parameters</span><span class="p">:</span>
  <span class="nb">type</span><span class="p">:</span> <span class="n">gp2</span>
</pre></div>
</div>
<p>Next, run this command:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>kubectl apply -f storageclass.yml
</pre></div>
</div>
</div></blockquote>
<p>This enables <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#dynamic">dynamic provisioning</a> of
disks, allowing us to automatically assign a disk per user when they log
in to JupyterHub.</p>
</li>
<li><p class="first">Enable legacy authorization mode. This is temporarily required since the newer
and more secure authorization mode is not out of beta yet.</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>kubectl create clusterrolebinding permissive-binding <span class="se">\</span>
 --clusterrole<span class="o">=</span>cluster-admin <span class="se">\</span>
 --user<span class="o">=</span>admin <span class="se">\</span>
 --user<span class="o">=</span>kubelet <span class="se">\</span>
 --group<span class="o">=</span>system:serviceaccounts
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<blockquote>
<div>This step should hopefully go away soon!</div></blockquote>
<p>You should now be ready for the next step.</p>
</div>
<div class="section" id="next-step">
<h2>Next Step<a class="headerlink" href="#next-step" title="Permalink to this headline">¶</a></h2>
<p>Now that you have a Kubernetes cluster running, it is time to
<a class="reference internal" href="setup-helm.html#setup-helm"><span class="std std-ref">set up helm</span></a>.</p>
</div>
</div>


  <div class='prev-next-bottom'>
    
     <a class='left-prev' href="getting-started.html" title="previous chapter">Getting started with JupyterHub</a>
     <a class='right-next' href="setup-helm.html" title="next chapter">Setting up Helm</a>
  <div style='clear:both;'></div>

  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">Zero to JupyterHub with Kubernetes</a></h1>



<p class="blurb">A tutorial to help install and manage JupyterHub with Kubernetes</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jupyterhub&repo=zero-to-jupyterhub-k8s&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<h3>Table of Contents</h3>
<p class="caption"><span class="caption-text">Creating your JupyterHub</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started with JupyterHub</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Creating a Kubernetes Cluster</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-kubernetes-on-google-cloud">Setting up Kubernetes on Google Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-kubernetes-on-microsoft-azure-container-service-acs">Setting up Kubernetes on Microsoft Azure Container Service (ACS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-kubernetes-on-amazon-web-services-aws">Setting up Kubernetes on Amazon Web Services (AWS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#next-step">Next Step</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="setup-helm.html">Setting up Helm</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup-jupyterhub.html">Setting up JupyterHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="turn-off.html">Turning Off JupyterHub and Computational Resources</a></li>
</ul>
<p class="caption"><span class="caption-text">Customization Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="extending-jupyterhub.html">Extending your JupyterHub setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-experience.html">Customizing the User Experience</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-management.html">User Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools used in a JupyterHub Deployment</a></li>
</ul>
<p class="caption"><span class="caption-text">Administrator Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="cost.html">Estimating costs</a></li>
<li class="toctree-l1"><a class="reference internal" href="backups.html">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrading.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Topics</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional-resources.html">Additional resources</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://github.com/jupyterhub/zero-to-jupyterhub-k8s">GitHub Repo</a></li>
    
    <li class="toctree-l1"><a href="http://github.com/jupyterhub/zero-to-jupyterhub-k8s/issues">Issue Tracker</a></li>
    
</ul>

<div class="relations">
<h3>Navigation</h3>
<ul>
  <li><a href="index.html">Documentation Home</a><ul>
  <li><a href="getting-started.html" title="Previous">Previous topic</a></li>
  <li><a href="setup-helm.html" title="Next">Next topic</a></li>
  </ul>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/create-k8s-cluster.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Project Jupyter team.
      
      |
      <a href="_sources/create-k8s-cluster.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>