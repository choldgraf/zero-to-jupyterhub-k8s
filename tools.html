
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tools used in a JupyterHub Deployment &#8212; Zero to JupyterHub with Kubernetes 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Resource management" href="resource-mgmt.html" />
    <link rel="prev" title="Extending your JupyterHub setup" href="extending-jupyterhub.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tools-used-in-a-jupyterhub-deployment">
<span id="tools"></span><h1>Tools used in a JupyterHub Deployment<a class="headerlink" href="#tools-used-in-a-jupyterhub-deployment" title="Permalink to this headline">¶</a></h1>
<p>JupyterHub is meant to connect with many tools in the world of
cloud computing and container technology. This page describes these
tools in greater detail in order to provide some more contextual
information.</p>
<div class="section" id="cloud-computing-providers">
<h2>Cloud Computing Providers<a class="headerlink" href="#cloud-computing-providers" title="Permalink to this headline">¶</a></h2>
<p>This is whatever will run the actual computation. Generally it means a
company, university server, or some other organization that hosts computers
that can be accessed remotely. JupyterHub will run on this hardware, meaning
that users will also be operating on this hardware if they’re interacting
with your JupyterHub.</p>
<p>They provide the following things:</p>
<ul class="simple">
<li>Computing</li>
<li>Disk space</li>
<li>Networking (both internal and external)</li>
<li>Creating, resizing, and deleting clusters</li>
</ul>
<p>Some of these organizations are companies
(e.g., <a class="reference external" href="http://cloud.google.com/">Google</a>), though JupyterHub
will work fine with university clusters or custom cluster deployments as well.
For these materials, any cluster with Kubernetes installed will work
with JupyterHub.</p>
<p>More information about setting up accounts services with cloud providers
can be found <a class="reference external" href="create-k8s-cluster.html">here</a>.</p>
</div>
<div class="section" id="container-technology">
<h2>Container Technology<a class="headerlink" href="#container-technology" title="Permalink to this headline">¶</a></h2>
<p>Container technology is essentially the idea of bundling all of the
necessary components to run a piece of software. There are many ways
to do this, but one that we’ll focus on is called Docker. Here are
the main concepts of Docker:</p>
<div class="section" id="container-image">
<h3>Container Image<a class="headerlink" href="#container-image" title="Permalink to this headline">¶</a></h3>
<p>Container images contain the dependencies required to run your code.
This includes <strong>everything</strong>, all the way down to the operating
system itself. It also includes things like the filesystem on which
your code runs, which might include data etc. Containers are also
portable, meaning that you can exactly recreate the computational
environment to run your code on almost any machine.</p>
<p>In Docker, images are described as layers, as in layers of dependencies.
For example, say you want to build a container that runs scikit-learn.
This has a dependency on Python, so you have two layers: one for
python, and another that inherits the python layer and adds the extra
piece of scikit-learn. Moreover, that base python layer needs an
operating system to run on, so now you have three layers:
ubuntu -&gt; python -&gt; scikit-learn. You get the idea. The beauty of this
is that it means you can share base layers between images. This
means that if you have many different images that all require
ubuntu, you don’t need to have many copies of ubuntu lying around.</p>
<p>Images can be created from many things. If you’re using Docker, the basic
way to do this is with a <strong>Dockerfile</strong>.
This is essentially a list of instructions that tells
Docker how to create an image. It might tell Docker which base layers
you want to include in an image, as well as some extra dependencies that
you need in the image. Think of it like a recipe that tells Docker how
to create an image.</p>
</div>
<div class="section" id="containers">
<h3>Containers<a class="headerlink" href="#containers" title="Permalink to this headline">¶</a></h3>
<p>You can “run” a container image, and it creates a container for you.
A container is a particular instantiation of a container image. This means
that it actually exists on a computer. It is a self-contained
computational environment that is constructed according to the layers
that are inside of the Container Image. However, because it is now
running on the computer, it can do other useful things like talk to other
Docker containers or communicate via the internet.</p>
</div>
</div>
<div class="section" id="kubernetes">
<h2>Kubernetes<a class="headerlink" href="#kubernetes" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://kubernetes.io/">Kubernetes</a> is a service that runs on cloud
infrastructures. It provides a single point of contact with the machinery
of your cluster deployment, and allows a user to specify the computational
requirements that they need (e.g., how many machines, how many CPUs
per machine, how much RAM). Then, it handles the resources on the cluster and
ensures that these resources are always available. If something goes down,
kubernetes will try to automatically bring it back up.</p>
<p>Kubernetes can only manage the computing resources that it is
given. This means that it generally can <strong>not</strong> create new resources on its
own (with the exception of disk space).</p>
<p>The following sections describe some objects in Kubernetes that are
most relevant for JupyterHub.</p>
<div class="section" id="processes">
<h3>Processes<a class="headerlink" href="#processes" title="Permalink to this headline">¶</a></h3>
<p>Are any program that is running on a machine. For example,
a Jupyter Notebook creates several processes that handle the
execution of code and the display in the browser. This isn’t
technically a Kubernetes object, since literally any computer has
processes that run on it, but Kubernetes does keep track of running
processes in order to ensure that they remain running if needed.</p>
</div>
<div class="section" id="pods">
<h3>Pods<a class="headerlink" href="#pods" title="Permalink to this headline">¶</a></h3>
<p>Pods are essentially a collection of one or more <em>containers</em> that
run together. You can think of them as a way of combining containers
that, as a group, accomplish some goal.</p>
<p>For example, say you want to create a web server that is open to the
world, but you also want authentication so that only a select group
of users can access it. You could use a single pod with two containers.</p>
<ul class="simple">
<li>One that does the authentication. It would have something like Apache
specified in its container image, and would be connected to the
outside world.</li>
<li>One that receives information from the authentication container, and
does something fancy with it (maybe it runs a python process).</li>
</ul>
<p>This is useful because it lets you compatmentalize the components of the
service that you want to run, which makes things easier to manage and
keeps things more stable.</p>
<p>For more information about pods, see the
<a class="reference external" href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/">Kubernetes documentation about pods</a>.</p>
</div>
<div class="section" id="deployments">
<h3>Deployments<a class="headerlink" href="#deployments" title="Permalink to this headline">¶</a></h3>
<p>A deployment is a collection of pods on kubernetes. It is how kubernetes
knows exactly what containers and what machines need to be running at all
times. For example, if you have two pods: one that does the authenticating
described above, and another that manages a database, you can specify both
in a deployment.</p>
<p>Kubernetes will ensure that both pods are active, and if
one goes down then it will try to re-create it. It does this by continually
checking the current state of the pods, and then comparing this with the
original specification of the deployment. If there are differences between
the current state vs. the specification of the deployment, Kubernetes will
attempt to make changes until the current state matches the specification.</p>
<p>For more information about deployments, see the
<a class="reference external" href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Kubernetes documentation about deployment</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Users don’t generally “create” deployments directly, they are
instead generated from a set of instructions that are sent to Kubernetes.
We’ll cover this in the section on “Helm”.</p>
</div>
</div>
<div class="section" id="service">
<h3>Service<a class="headerlink" href="#service" title="Permalink to this headline">¶</a></h3>
<p>A service is simply a stable way of referring to a deployment. Kubernetes
is all about intelligently handling dynamic and quickly-changing
computational environments. This means that the hardware may change,
IP addresses will be different, etc. However you don’t want to have to
re-orient yourself every time this happens. A Kubernetes service keeps
track of all these changes on the backend, and provides a single address
to manage your deployment.</p>
<p>For more information about services, see the
<a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/service/">Kubernetes documentation about services</a>.</p>
</div>
<div class="section" id="namespace">
<h3>Namespace<a class="headerlink" href="#namespace" title="Permalink to this headline">¶</a></h3>
<p>Finally, a <a class="reference external" href="https://kubernetes.io/docs/admin/namespaces/">namespace</a>
defines a collection of objects in Kubernetes. This will define
the boundaries of hardware that the deployments have to exist within. It
is generally the most “high-level” of the groups we’ve discussed thus far.
For example, a a namespace could be a single class running with JupyterHub.
It defines all the hardware that is available to students. It also defines
the JupyterHub machinery that glues together all of the student containers,
manages disk space, etc.</p>
<p>For more information about namespaces, see the
<a class="reference external" href="https://kubernetes.io/docs/tasks/administer-cluster/namespaces/">Kubernetes documentation on namespaces</a>.</p>
</div>
<div class="section" id="persistent-volume-claim">
<h3>Persistent Volume Claim<a class="headerlink" href="#persistent-volume-claim" title="Permalink to this headline">¶</a></h3>
<p>Persistent Volume Claims are a way to have persistent storage without
being tied down to one specific computer or machine. Kubernetes is
about that flexibility, and that means that we don’t want to lock ourselves
in to a particular operating system just because our files are already
on it. Persistent Volume Claims help deal with this problem by knowing
how to convert files between disk types (e.g., AWS vs. Google disks).</p>
<p>For more information on Persistent Volume Claims, see the
<a class="reference external" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">Kubernetes documentation on persistent volumes</a>.</p>
</div>
</div>
<div class="section" id="helm">
<h2>Helm<a class="headerlink" href="#helm" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://helm.sh/">Helm</a> is a way of specifying kubernetes objects
with a standard template.</p>
<div class="section" id="charts">
<h3>Charts<a class="headerlink" href="#charts" title="Permalink to this headline">¶</a></h3>
<p>The way that Helm controls kubernetes is with templates of structured
information that specify some computational requirements.
These templates are called “charts”, or “helm charts”. They contain
all of the necessary information for kubernetes to generate:</p>
<ul class="simple">
<li>a deployment object</li>
<li>a service object</li>
<li>a persistent volume object a deployment.</li>
<li>collections of the above components</li>
</ul>
<p>They can be installed into a namespace, which causes kubernetes to
begin deploying the objects above into that namespace.</p>
<p>Charts have both names and versions, which means that you can easily
update them and build off of them. There are
<a class="reference external" href="https://github.com/kubernetes/charts/tree/master/stable">community maintained charts</a>
available, and we use a chart to install and upgrade JupyterHub in
this guide. In our case, the helm chart is a file called <code class="docutils literal"><span class="pre">config.yaml</span></code>.</p>
</div>
<div class="section" id="releases">
<h3>Releases<a class="headerlink" href="#releases" title="Permalink to this headline">¶</a></h3>
<p>A release is basically a specific instantiation of a helmchart inserted
into a particular namespace. If you’d like to upgrade your
kubernetes deployment (say, by changing the amount of RAM that each
user should get), then you can change the helm chart, then re-deploy
it to your kubernetes cluster. This generates a new version of the release.</p>
</div>
</div>
<div class="section" id="jupyterhub">
<h2>JupyterHub<a class="headerlink" href="#jupyterhub" title="Permalink to this headline">¶</a></h2>
<p>JupyterHub is a way of utilizing the components above in order to
provide computational environments that users can access remotely.
It exists as two kubernetes deployments, Proxy and Hub, each of which has
one pod. Each deployment accomplishes some task that, together, make up JupyterHub.
Finally, the output of JupyterHub is a user pod, which specifies the
computational environment in which a single user will operate. So
essentially a JupyterHub is a collection of:</p>
<ul class="simple">
<li>Pods that contain the JupyterHub Machiner</li>
<li>A bunch of user pods that are constantly being created or destroyed.</li>
</ul>
<p>Below we’ll describe the primary JupyterHub pods.</p>
<div class="section" id="proxy-pod">
<h3>Proxy Pod<a class="headerlink" href="#proxy-pod" title="Permalink to this headline">¶</a></h3>
<p>This is the user-facing pod. It provides the IP address that people will
go to in order to access JupyterHub. When a new users goes to this pod,
it will decide whether to:</p>
<ul class="simple">
<li>send that user to the Hub pod, which will create a container for that
user, or</li>
<li>if that user’s container already exists, send them directly to that
container instead.</li>
</ul>
<p>Information about the user’s identity is stored as a cookie on their
computer. This is how the proxy pod knows whether a user already has
a running container.</p>
</div>
<div class="section" id="hub-pod">
<h3>Hub Pod<a class="headerlink" href="#hub-pod" title="Permalink to this headline">¶</a></h3>
<p>Receives traffic from the proxy pod. It has 3 main running processes:</p>
<ol class="arabic simple">
<li>An authenticator, which can verify a user’s account. It also contains a
process.</li>
<li>A “KubeSpawner” that talks to the kubernetes API and tells it to spawn
pods for users if one doesn’t already exist. KubeSpawner will tell
kubernetes to create a pod for a new user, then it will tell the
the Proxy Pod that the user’s pod has been created.</li>
<li>An admin panel that has information about who has pods created, and
what kind of usage exists on the cluster.</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tools used in a JupyterHub Deployment</a><ul>
<li><a class="reference internal" href="#cloud-computing-providers">Cloud Computing Providers</a></li>
<li><a class="reference internal" href="#container-technology">Container Technology</a><ul>
<li><a class="reference internal" href="#container-image">Container Image</a></li>
<li><a class="reference internal" href="#containers">Containers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kubernetes">Kubernetes</a><ul>
<li><a class="reference internal" href="#processes">Processes</a></li>
<li><a class="reference internal" href="#pods">Pods</a></li>
<li><a class="reference internal" href="#deployments">Deployments</a></li>
<li><a class="reference internal" href="#service">Service</a></li>
<li><a class="reference internal" href="#namespace">Namespace</a></li>
<li><a class="reference internal" href="#persistent-volume-claim">Persistent Volume Claim</a></li>
</ul>
</li>
<li><a class="reference internal" href="#helm">Helm</a><ul>
<li><a class="reference internal" href="#charts">Charts</a></li>
<li><a class="reference internal" href="#releases">Releases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jupyterhub">JupyterHub</a><ul>
<li><a class="reference internal" href="#proxy-pod">Proxy Pod</a></li>
<li><a class="reference internal" href="#hub-pod">Hub Pod</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="extending-jupyterhub.html" title="previous chapter">Extending your JupyterHub setup</a></li>
      <li>Next: <a href="resource-mgmt.html" title="next chapter">Resource management</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Project Jupyter team.
      
      |
      <a href="_sources/tools.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>